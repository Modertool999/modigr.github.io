<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Modi Goldstein‑Rosenfeld — Projects</title>
  <!-- Tailwind CDN (no build step) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Chart.js for the SPY equity curve -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.6/dist/chart.umd.min.js"></script>
  <meta name="color-scheme" content="light dark" />
  <style>
    /* Hide default spinners for number input on WebKit */
    input[type=number]::-webkit-outer-spin-button,
    input[type=number]::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
  </style>
</head>
<body class="bg-zinc-50 text-zinc-900 dark:bg-zinc-950 dark:text-zinc-100">
  <main class="max-w-5xl mx-auto px-4 py-8">
    <header class="mb-8">
      <h1 class="text-3xl font-bold tracking-tight">Modi Goldstein‑Rosenfeld</h1>
      <p class="text-zinc-600 dark:text-zinc-400">I build data‑driven tools. These two recent projects call my live backends.</p>
      <div class="text-sm mt-2 flex gap-4">
        <a class="underline" href="https://github.com/Modertool999/game-recommender" target="_blank" rel="noopener">Steam Game Recommender (repo)</a>
        <a class="underline" href="https://github.com/Modertool999/spy-forecast" target="_blank" rel="noopener">SPY Forecaster (repo)</a>
      </div>
    </header>

    <!-- Config Block: paste your live API URLs here -->
    <script>
      const CONFIG = {
        endpoints: {
          // Replace these with your live URLs when ready:
          steamRec: 'https://steam-rec-modi-2-gdefgecbdah9hqfx.westus-01.azurewebsites.net/api/recommend',
          spyForecast: 'https://spy-forecast-modi-2-gka4h2cng6dhcvcf.westus-01.azurewebsites.net/api/spy-backtest'
        },
        requestTimeoutMs: 20000
      };
    </script>

    <section class="space-y-6">
      <h2 class="text-2xl font-semibold">Recent Projects — live</h2>

      <!-- Steam Game Recommender Card -->
      <article class="rounded-2xl border border-zinc-200 dark:border-zinc-800 p-5 bg-white/70 dark:bg-zinc-900/40 backdrop-blur">
        <div class="flex items-start justify-between gap-4">
          <div>
            <h3 class="text-xl font-semibold">Steam Game Recommender</h3>
            <p class="text-sm text-zinc-600 dark:text-zinc-400">Enter your <strong>SteamID64</strong> (17 digits starting with <code>7656119</code>). Weights let you balance TF‑IDF content vs. friends' playtime.</p>
            <p class="text-xs text-zinc-500 mt-1">Don’t know it? Use <a class="underline" href="https://steamid.io/lookup" target="_blank" rel="noopener">steamid.io/lookup</a> → copy the <em>SteamID64</em>.</p>
          </div>
          <a class="text-sm underline" href="https://github.com/Modertool999/game-recommender" target="_blank" rel="noopener">Repo ↗</a>
        </div>

        <form id="steamForm" class="mt-4 grid gap-4">
          <div class="grid sm:grid-cols-3 gap-4">
            <label class="text-sm">SteamID64
              <input id="steamId" inputmode="numeric" pattern="^7656119\\d{10}$" class="mt-1 w-full rounded-xl border border-zinc-300 dark:border-zinc-700 bg-transparent px-3 py-2" placeholder="7656119XXXXXXXXXX" required />
            </label>
            <label class="text-sm">Content weight (TF‑IDF)
              <input id="wContent" type="range" min="0" max="1" step="0.05" value="0.6" class="mt-3 w-full" />
            </label>
            <label class="text-sm">Playtime weight
              <input id="wPlay" type="range" min="0" max="1" step="0.05" value="0.4" class="mt-3 w-full" />
            </label>
          </div>

          <div class="flex flex-wrap items-center gap-3">
            <button id="recBtn" type="submit" class="rounded<!-- SPY Forecaster Card -->
      <article class="rounded-2xl border border-zinc-200 dark:border-zinc-800 p-5 bg-white/70 dark:bg-zinc-900/40 backdrop-blur">
        <div class="flex items-start justify-between gap-4">
          <div>
            <h3 class="text-xl font-semibold">S&P 500 Next‑Day Forecaster</h3>
            <p class="text-sm text-zinc-600 dark:text-zinc-400">Clean inputs → clear output. Choose a probability threshold; optional dates refine the backtest window.</p>
          </div>
          <a class="text-sm underline" href="https://github.com/Modertool999/spy-forecast" target="_blank" rel="noopener">Repo ↗</a>
        </div>

        <form id="spyForm" class="mt-4 space-y-3">
          <div class="grid sm:grid-cols-4 gap-3">
            <label class="text-sm flex items-center gap-2">Threshold
              <input id="thr" type="number" min="0" max="1" step="0.01" value="0.55" class="rounded-lg border border-zinc-300 dark:border-zinc-700 bg-transparent px-2 py-1 w-24" />
            </label>
            <label class="text-sm">Start (YYYY‑MM‑DD)
              <input id="startDate" type="text" placeholder="optional" class="mt-1 rounded-lg border border-zinc-300 dark:border-zinc-700 bg-transparent px-2 py-1 w-full" />
            </label>
            <label class="text-sm">End
              <input id="endDate" type="text" placeholder="optional" class="mt-1 rounded-lg border border-zinc-300 dark:border-zinc-700 bg-transparent px-2 py-1 w-full" />
            </label>
            <div class="flex items-end gap-2">
              <button id="runBacktest" type="submit" class="rounded-lg px-3 py-1.5 bg-zinc-900 text-white dark:bg-white dark:text-zinc-900 disabled:opacity-50">Run backtest</button>
              <button id="resetBacktest" type="button" class="rounded-lg px-3 py-1.5 border border-zinc-300 dark:border-zinc-700">Reset</button>
            </div>
          </div>
          <div class="flex items-center gap-2 text-xs text-zinc-500"><span id="btStatus"></span></div>
        </form>

        <div class="mt-4">
          <canvas id="equityChart" height="140"></canvas>
        </div>
        <div id="btStatsWrap" class="mt-3 grid sm:grid-cols-2 gap-3">
          <div class="rounded-xl border border-zinc-200 dark:border-zinc-800 p-3"><p id="btStats" class="text-sm"></p></div>
          <div class="rounded-xl border border-zinc-200 dark:border-zinc-800 p-3"><p class="text-sm text-zinc-600 dark:text-zinc-400">Tip: higher thresholds trade less; try 0.60–0.65 and compare.</p></div>
        </div>
      </article>

      <!-- More projectsunBacktest" class="rounded-lg px-3 py-1.5 bg-zinc-900 text-white dark:bg-white dark:text-zinc-900">Run backtest</button>
          <button id="resetBacktest" class="rounded-lg px-3 py-1.5 border border-zinc-300 dark:border-zinc-700">Reset</button>
          <span id="btStatus" class="text-xs text-zinc-500"></span>
        </div>

        <div class="mt-4">
          <canvas id="equityChart" height="120"></canvas>
        </div>
        <p id="btStats" class="text-sm text-zinc-700 dark:text-zinc-300 mt-2"></p>
      </article>

      <!-- More projects (static links) -->
      <article class="rounded-2xl border border-zinc-200 dark:border-zinc-800 p-5">
        <h3 class="text-lg font-semibold">More projects</h3>
        <ul class="list-disc pl-5 text-sm mt-2 space-y-1">
          <li><a class="underline" href="https://github.com/Cornell-Fintech-Club/algo-oil" target="_blank" rel="noopener">Oil Trading Model (Cornell FinTech Club)</a> — headline sentiment → signal (code + write‑up).</li>
        </ul>
      </article>
    </section>
  </main>

  <script>
    // ---------- Helpers ----------
    const qs = (sel) => document.querySelector(sel);
    function setStatus(el, msg, ok=false){ el.textContent = msg; el.className = `text-xs ${ok? 'text-green-600 dark:text-green-400':'text-zinc-500'}`; }
    function isSteam64(s){ return /^7656119\d{10}$/.test(s); }

    function fetchWithTimeout(url, options={}, timeoutMs=15000){
      const controller = new AbortController();
      const id = setTimeout(()=>controller.abort(), timeoutMs);
      return fetch(url, {...options, signal: controller.signal}).finally(()=>clearTimeout(id));
    }

    // ---------- Steam Recommender ----------
    const steamForm = qs('#steamForm');
    steamForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      const btn = qs('#recBtn');
      const steamId = (qs('#steamId').value || '').trim();
      const wContent = parseFloat(qs('#wContent').value || '0.6');
      const wPlay = parseFloat(qs('#wPlay').value || '0.4');
      const status = qs('#recStatus');
      const list = qs('#recList');
      const err = qs('#recError');
      list.innerHTML = ''; err.classList.add('hidden'); err.textContent='';

      if (!CONFIG.endpoints.steamRec){ setStatus(status, 'Not configured.'); return; }
      if (!isSteam64(steamId)){ err.textContent = 'Invalid SteamID64. It should be 17 digits starting with 7656119.'; err.classList.remove('hidden'); return; }

      try {
        btn.disabled = true; setStatus(status, 'Calling backend…');
        const u = new URL(CONFIG.endpoints.steamRec);
        u.searchParams.set('steam_id', steamId);
        u.searchParams.set('k', 10);
        u.searchParams.set('w_content', wContent);
        u.searchParams.set('w_playtime', wPlay);
        const res = await fetchWithTimeout(u.toString(), { method: 'GET' }, CONFIG.requestTimeoutMs);
        if (!res.ok) { const txt = await res.text(); throw new Error(`HTTP ${res.status}: ${txt.slice(0,140)}`); }
        const data = await res.json();
        if (!Array.isArray(data) || data.length===0){ setStatus(status, 'No recommendations (account privacy/recent playtime?).'); return; }
        data.slice(0,10).forEach(r => {
          const li = document.createElement('li');
          const score = (typeof r.score === 'number') ? ` — score ${(r.score*100).toFixed(0)}%` : '';
          li.textContent = `${r.title}${score}`;
          list.appendChild(li);
        });
        setStatus(status, 'Done.', true);
      } catch (e){ console.error(e); setStatus(status, `Error: ${e.message || e}`); }
      finally { btn.disabled = false; }
    });
    qs('#recReset').addEventListener('click', ()=>{ qs('#steamId').value=''; qs('#recList').innerHTML=''; qs('#recStatus').textContent=''; qs('#recError').classList.add('hidden'); });

    // ---------- SPY Forecaster ----------
    let chart;
    function ensureChart(){
      if (chart) return chart;
      const ctx = document.getElementById('equityChart').getContext('2d');
      chart = new Chart(ctx, {
        type: 'line',
        data: { labels: [], datasets: [{ label: 'Equity (×)', data: [], borderWidth: 2, pointRadius: 0, tension: 0.15 }] },
        options: {
          responsive: true,
          animation: false,
          scales: { y: { beginAtZero: false } },
          plugins: { legend: { display: false } }
        }
      });
      return chart;
    }

    async function runBacktest(){
      const status = qs('#btStatus');
      const stats = qs('#btStats');
      const btn = qs('#runBacktest');
      const thr = parseFloat(qs('#thr').value || '0.55');
      const start = (qs('#startDate').value || '').trim() || null;
      const end = (qs('#endDate').value || '').trim() || null;
      stats.textContent = '';
      const ch = ensureChart();

      if (!CONFIG.endpoints.spyForecast){ setStatus(status, 'Not configured.'); return; }
      try {
        btn.disabled = true; setStatus(status, 'Running backtest…');
        const body = { threshold: thr }; if (start) body.start = start; if (end) body.end = end;
        const res = await fetchWithTimeout(CONFIG.endpoints.spyForecast, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(body) }, CONFIG.requestTimeoutMs);
        if (!res.ok){ const txt=await res.text(); throw new Error(`HTTP ${res.status}: ${txt.slice(0,160)}`); }
        const data = await res.json();
        const eq = Array.isArray(data.equity) ? data.equity : [];
        if (eq.length === 0){ setStatus(status, 'No equity data returned.'); return; }
        ch.data.labels = eq.map((_,i)=>i);
        ch.data.datasets[0].data = eq;
        ch.update();
        const toPct = (x)=> (Number(x)||0).toFixed(2);
        const tr = toPct(data.total_ret);
        const cagr = toPct(data.cagr);
        const sharpe = data.sharpe != null ? ` · Sharpe ${toPct(data.sharpe)}` : '';
        const mdd = data.max_drawdown != null ? ` · Max DD ${toPct(data.max_drawdown)}%` : '';
        stats.textContent = `Total return ${tr}% · CAGR ${cagr}%${sharpe}${mdd}`;
        setStatus(status, 'Done.', true);
      } catch (e){ console.error(e); setStatus(status, `Error: ${e.message || e}`); }
      finally { btn.disabled = false; }
    }

    qs('#spyForm').addEventListener('submit', (e)=>{ e.preventDefault(); runBacktest(); });
    qs('#resetBacktest').addEventListener('click', () => {
      const ch = ensureChart(); ch.data.labels = []; ch.data.datasets[0].data = []; ch.update();
      qs('#btStats').textContent=''; qs('#btStatus').textContent='';
    });
    qs('#resetBacktest').addEventListener('click', () => {
      const ch = ensureChart();
      ch.data.labels = []; ch.data.datasets[0].data = []; ch.update();
      qs('#btStats').textContent=''; qs('#btStatus').textContent='';
    });
  </script>
</body>
</html>
